# name: test/sql/mlpack_kmeans.test
# description: test kmeans in mlpack extension
# group: [sql]

require mlpack

statement ok
PRAGMA enable_verification

# running commands from sampleCall.sh 

statement ok
CREATE TABLE X AS SELECT * FROM read_csv("docs/data/logistic_x.csv");

statement ok
CREATE TABLE Z (name VARCHAR, value VARCHAR);

statement ok
INSERT INTO Z VALUES ('clusters', '5');

statement ok
CREATE TABLE M (key VARCHAR, json VARCHAR);

statement ok
CREATE TABLE A AS SELECT * FROM mlpack_kmeans("X", "Z", "M");

statement ok
SELECT * FROM M WHERE key = 'assignments';

query I
SELECT max(predicted) + 1 AS n FROM A;
----
5


